# 챗봇 대시보드 질문 시 토큰 사용량 분석

## 📊 현재 구현 상태

### 대시보드 데이터 전송 방식
**중요**: 현재 구현에서는 **대시보드 데이터가 직접 전송되지 않습니다**.
- 챗봇은 사용자 메시지와 대화 히스토리만 받음
- 대시보드의 실제 데이터(생산량, 품질률 등)는 전송되지 않음
- 챗봇은 일반적인 지식으로만 답변

### 선택적 기능 (키워드 기반)
1. **RAG (웹사이트 문서 검색)**: "웹사이트", "문서", "참고" 키워드 포함 시
2. **공지사항**: "공지", "notice" 키워드 포함 시
3. **커뮤니케이션**: "커뮤니", "소통", "communication" 키워드 포함 시

## 💰 토큰 사용량 시나리오

### 시나리오 1: 일반 질문 (최소 토큰)
**예시**: "오늘 생산량은 얼마야?", "품질률이 낮은 이유는?"

**전송 데이터**:
- 사용자 메시지: ~20-50 토큰
- 대화 히스토리: 최근 10개 메시지 (~100-300 토큰)
- 프롬프트 템플릿: ~150-200 토큰
- 사용자 정보: ~10 토큰

**입력 토큰**: 약 **280-560 토큰**
**출력 토큰**: 약 **100-300 토큰** (응답 길이에 따라)
**총 토큰**: 약 **380-860 토큰**

**참고**: 대시보드 실제 데이터는 전송되지 않으므로, 챗봇은 일반적인 답변만 제공합니다.

---

### 시나리오 2: RAG 사용 질문 (중간 토큰)
**예시**: "웹사이트 정보 참고해서 대시보드 사용법 알려줘"

**전송 데이터**:
- 사용자 메시지: ~30-60 토큰
- 대화 히스토리: ~100-300 토큰
- 프롬프트 템플릿: ~150-200 토큰
- RAG 관련 문서: ~200-500 토큰 (검색된 문서 3개)
- 사용자 정보: ~10 토큰

**RAG 임베딩 호출**: 
- 입력: 사용자 메시지 (~30-60 토큰)
- **임베딩 토큰**: 약 **30-60 토큰**

**생성 API 호출**:
- 입력 토큰: 약 **480-1,070 토큰**
- 출력 토큰: 약 **150-400 토큰**
- **생성 토큰**: 약 **630-1,470 토큰**

**총 토큰**: 약 **660-1,530 토큰**

---

### 시나리오 3: 공지사항 포함 질문 (높은 토큰)
**예시**: "공지사항 확인해서 최근 변경사항 알려줘"

**전송 데이터**:
- 사용자 메시지: ~30-60 토큰
- 대화 히스토리: ~100-300 토큰
- 프롬프트 템플릿: ~150-200 토큰
- 공지사항 전체: ~500-2,000 토큰 (공지사항 개수와 길이에 따라)
- 사용자 정보: ~10 토큰

**입력 토큰**: 약 **790-2,570 토큰**
**출력 토큰**: 약 **150-400 토큰**
**총 토큰**: 약 **940-2,970 토큰**

---

### 시나리오 4: 모든 기능 사용 (최대 토큰)
**예시**: "웹사이트 문서와 공지사항 참고해서 대시보드 사용법과 최근 변경사항 알려줘"

**전송 데이터**:
- 사용자 메시지: ~50-80 토큰
- 대화 히스토리: ~100-300 토큰
- 프롬프트 템플릿: ~150-200 토큰
- RAG 관련 문서: ~200-500 토큰
- 공지사항 전체: ~500-2,000 토큰
- 커뮤니케이션: ~300-1,000 토큰
- 사용자 정보: ~10 토큰

**RAG 임베딩**: 약 **50-80 토큰**
**생성 API**:
- 입력: 약 **1,310-4,080 토큰**
- 출력: 약 **200-500 토큰**
- **생성 토큰**: 약 **1,510-4,580 토큰**

**총 토큰**: 약 **1,560-4,660 토큰**

## 📈 토큰 사용량 요약표

| 시나리오 | 질문 유형 | RAG | 공지/커뮤니 | 총 토큰 사용량 |
|---------|---------|-----|------------|--------------|
| 1 | 일반 질문 | ❌ | ❌ | **380-860 토큰** |
| 2 | RAG 사용 | ✅ | ❌ | **660-1,530 토큰** |
| 3 | 공지사항 포함 | ❌ | ✅ | **940-2,970 토큰** |
| 4 | 모든 기능 | ✅ | ✅ | **1,560-4,660 토큰** |

## ⚠️ 중요 사항

### 현재 제한사항
1. **대시보드 실제 데이터 미전송**: 
   - 챗봇은 대시보드의 실제 데이터(생산량, 품질률 등)를 받지 않음
   - 일반적인 지식으로만 답변
   - "오늘 생산량은?" 같은 질문에 정확한 수치를 알려줄 수 없음

2. **대시보드 데이터를 활용하려면**:
   - 챗봇 API에 대시보드 데이터를 추가로 전송해야 함
   - 이 경우 토큰 사용량이 크게 증가할 수 있음

### 토큰 절약 팁
1. **일반 질문**: 키워드 없이 질문 → 최소 토큰 사용
2. **필요할 때만 RAG 사용**: "웹사이트 정보 참고" 키워드 포함
3. **공지사항은 필요할 때만**: "공지사항 확인" 키워드 포함

## 💡 대시보드 데이터 활용 시 예상 토큰

만약 대시보드 실제 데이터를 전송한다면:

**대시보드 데이터 예시**:
- 생산량, 품질률, 설비 가동률, 에너지 사용량 등
- 예상 크기: ~500-1,500 토큰

**추가 토큰 사용량**: 약 **500-1,500 토큰**

**총 토큰 (대시보드 데이터 포함)**:
- 일반 질문: **880-2,360 토큰**
- RAG 사용: **1,160-3,030 토큰**
- 공지사항 포함: **1,440-4,470 토큰**
- 모든 기능: **2,060-6,160 토큰**
